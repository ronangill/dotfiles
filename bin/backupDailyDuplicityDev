#!/bin/bash

PERIOD="daily"
MODE="duplicity"
SRC="/"
DEST="rsync://diskstation//volume1/Backups/$(hostname -s)-${MODE}-${PERIOD}-BACKUPS"

echo "daily backup: Backing up [${SOURCE}] to [${DEST}]"
duplicity --no-encryption --full-if-older-than 7D  \
          --include  /data/dev/jira \
          --include  /data/dev/projects \
          --include  /data/dev/src \
          --include  /data/dev/usrlocal \
          --exclude  '**'  \
          ${SRC} ${DEST}
duplicity remove-all-but-n-full 6 --force ${DEST}


echo "$0 - $(date +"%F %T") backup finished"
